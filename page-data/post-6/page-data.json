{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/post-6/",
    "result": {"data":{"site":{"siteMetadata":{"title":"paerck25.logger"}},"markdownRemark":{"id":"d960ac2f-26da-5e63-b0bb-25fa8cc2bba8","excerpt":"Nginx 404 리액트 프로젝트를 빌드 후 nginx로 띄워봤습니다.\n얼핏 보면 정상적으로 동작 하는 것 같았지만 한 단계 경로를 거친 상태에서 새로고침을 하니\n404 페이지가 나타났습니다.\n구글링 결과, 처음 index…","html":"<h2>Nginx 404</h2>\n<p>리액트 프로젝트를 빌드 후 nginx로 띄워봤습니다.<br>\n얼핏 보면 정상적으로 동작 하는 것 같았지만 한 단계 경로를 거친 상태에서 새로고침을 하니<br>\n404 페이지가 나타났습니다.<br>\n구글링 결과,</p>\n<blockquote>\n<p>처음 index 페이지에 접근 한 후의 경로 변경은 브라우저 자체에서 처리되지만,<br>\n한 단계 경로를 거친 상태로 새로 고치거나 새로 열면 요청이 nginx쪽에서 경로가 없는 곳으로 이동하기 때문에 404 페이지가 표시된다.</p>\n</blockquote>\n<p>라고 합니다. 때문에 nginx.conf 설정을 바꾸어 주어야 하는데,</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n        try_files $uri $uri/ /index.html;  &lt;-- 이 항목을 추가해 주어야 합니다.\n}</code></pre></div>\n<p>이것은 nginx에서 지정된 uri에서 찾을 수 없으면 index.html 브라우저로 보낸다고 합니다.</p>\n<h2>ChunkLoadError</h2>\n<p>위와 같이 빌드 후에 “example.com/a” 경로까지는 정상적으로 화면이 나타났지만,<br>\n“example.com/a/:id” 경로에 접근하니 흰 화면을 띄우며 콘솔창에는</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 610px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26bde868086d1a2c96a863a5858142ca/5aae9/chunk_error.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.962025316455696%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAATklEQVQI1wXBWwqAIBBA0fa/qRCJnB6ogfZRq+gnnKlu53QtCFcpPDnyDZ5vFl7Xc0tAt4SdBy1F1DtsmbBaUBnRHLG9orXQ4kqbBNsyP00NR5dNJfcwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"chunk_error\"\n        title=\"chunk_error\"\n        src=\"/static/26bde868086d1a2c96a863a5858142ca/5aae9/chunk_error.png\"\n        srcset=\"/static/26bde868086d1a2c96a863a5858142ca/c26ae/chunk_error.png 158w,\n/static/26bde868086d1a2c96a863a5858142ca/6bdcf/chunk_error.png 315w,\n/static/26bde868086d1a2c96a863a5858142ca/5aae9/chunk_error.png 610w\"\n        sizes=\"(max-width: 610px) 100vw, 610px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이러한 에러가 나타났습니다.<br>\n<br>\n“/a” 경로까지는 정상적으로 나타나길래 react-router 사용이 잘못되었나 싶어 이리 고치고 저리 고쳐봤지만 소용이 없었습니다.<br>\n<br>\n계속 삽질하는 와중에 React.Lazy를 함부로 사용하면 안된다는 글을 보고 혹시나 싶어 지워봤더니 정상동작은 하였지만, code-splitting은 하고 싶었고, 이런 해결로는 찝찝함이 가시지가 않아서 계속 구글링 한 결과,\n<br>\npackage.json의 homepage 라는 필드를 지우면 된다는 스택오버플로우 글을 보고</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"homepage\" : \".\", &lt;&lt;-- 삭제</code></pre></div>\n<p>이렇게 되어있던 부분을 지워봤더니 React.Lazy를 사용한 채로도 정상 동작이 되었습니다.<br>\n<br>\n무슨 원리인가 싶어 찾아보니 package.json의 homepage가\n리액트의 PUBLIC_URL 환경변수에 영향을 주어, 경로가 바뀌는 것 같았습니다.<br>\n<br>\n하지만 아직 의문인건 PUBLIC_URL이 바뀌었으면 왜 “/a”경로까지는 정상적으로 나타났는지…<br></p>","frontmatter":{"title":"React Build Error 기록 - nginx 404, ChunkLoadError","date":"2022-03-19, 11:00 pm","description":"빌드 후 에러"}},"previous":{"fields":{"slug":"/post-5/"},"frontmatter":{"title":"Github Action - 태그, 버전 릴리즈 자동화하기"}},"next":{"fields":{"slug":"/post-7/"},"frontmatter":{"title":"styled-components Warning 기록 - Unknown Prop Warning"}}},"pageContext":{"id":"d960ac2f-26da-5e63-b0bb-25fa8cc2bba8","previousPostId":"c994b363-a1e2-57f3-9412-87f96e3391b6","nextPostId":"f3682589-53e0-503f-a6dc-b3803895432c"}},
    "staticQueryHashes": ["2841359383","3257411868"]}